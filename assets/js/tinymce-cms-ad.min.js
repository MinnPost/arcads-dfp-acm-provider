tinymce.create("tinymce.plugins.cms_ad",{init:function(t,e){var n=this;n.url=e,t.onBeforeSetContent.add(function(e,t){t.content=n._do_cms_ad(t.content)}),t.onExecCommand.add(function(e,t){"mceInsertContent"===t&&tinyMCE.activeEditor.setContent(n._do_cms_ad(tinyMCE.activeEditor.getContent()))}),t.onPostProcess.add(function(e,t){t.get&&(t.content=n._get_cms_ad(t.content))}),t.addCommand("cms_ad",function(){var e=prompt("Enter the ad code to insert");e&&0!==e.length&&t.execCommand("mceReplaceContent",!1,"[cms_ad:"+e+"]")}),t.addButton("cms_ad",{title:"Insert Ad Shortcode",cmd:"cms_ad",image:e+"/../img/tinymce-icon.png"})},_do_cms_ad:function(e){return e.replace(/\[([cms_ad:]+):([^:\]]+)\]/g,function(e,t,n){return'<img src="/wp-content/plugins/arcads-dfp-acm-provider/assets/img/'+t+'.png" class="mceItem mceAdShortcode mceAdShortcode'+tinymce.DOM.encode(n)+'" alt="'+tinymce.DOM.encode(t)+":"+tinymce.DOM.encode(n)+'" data-shortcode="'+tinymce.DOM.encode(t)+'" data-shortcode-type="'+tinymce.DOM.encode(n)+'" data-mce-resize="false" data-mce-placeholder="1">'})},_get_cms_ad:function(e){function d(e,t){return(t=new RegExp(t+'="([^"]+)"',"g").exec(e))?tinymce.DOM.decode(t[1]):""}return e.replace(/(?:<p[^>]*>)*(<img[^>]+>)(?:<\/p>)*/g,function(e,t){var n=tinymce.trim(d(t,"class")),c=tinymce.trim(d(t,"data-shortcode")),o=tinymce.trim(d(t,"data-shortcode-type"));return-1!==n.indexOf("mceAdShortcode")&&""!==c&&""!==o?"["+c+":"+o+"]":e})},getInfo:function(){return{longname:"cms_ad shortcode replace",author:"MinnPost",infourl:"",version:"1.0"}}}),tinymce.PluginManager.add("cms_ad",tinymce.plugins.cms_ad);